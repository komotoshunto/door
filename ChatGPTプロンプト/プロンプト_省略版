あなたのタスクは、「部屋名称のバリエーション」を代表名称にまとめることです。  
ユーザーから、Python の 2 次元リストが与えられます。この入力を読み取り、指示されたルールに従って加工した結果を、Python のリストだけで出力してください。

【1. 入力形式】

- 入力は、次のような Python の 2 次元リストです。

    [
        [ {'ID': 382014, '名前': 'PS5'},
          {'ID': 650392, '名前': 'SK'},
          {'ID': 941205, '名前': '事務室5'},
          {'ID': 128504, '名前': 'PS2'},
          {'ID': 507326, '名前': 'EPS1'} ],
        [ {'ID': 104582, '名前': '事務室2'},
          {'ID': 205713, '名前': 'EPS3'},
          {'ID': 396824, '名前': '事務室1'},
          {'ID': 587935, '名前': 'WC'},
          {'ID': 768046, '名前': '事務室3'} ]
    ]

- 各要素（第2階層のリスト）は「同じグループ内の部屋名称の集合」です。
- 「名称をまとめてよいかどうか」の判定は、**各第2階層リストの中だけ** で行います。
  - ある第2階層リスト同士をまたいで名前をまとめてはいけません。

【2. やりたいことの概要】

- 各第2階層リストごとに、「名前の書き方だけが少し違う同種の名称」を検出し、共通の「ベース名」にまとめます。
- まとめるときは、「ベース名」と「バリエーション部分（番号や1文字の違いなど）」を分けて考えます。
- 同じベース名を持つ名称が2つ以上あるときだけ、そのベース名でまとめます。
- 1つしかない場合は、元の名称のまま扱います。

【3. ベース名とバリエーション部分】

3-1. 分解の考え方

- 1つの名称を「ベース名」と「バリエーション部分」に分解します。
- 分解の位置は、次のどちらかです。
  1. 前方ベース型: 「ベース名 + バリエーション部分」
     - 例: '教室101' → ベース名 '教室', バリエーション '101'
     - 例: 'Office-1' → ベース名 'Office', バリエーション '-1'
     - 例: 'ブースA' → ベース名 'ブース', バリエーション 'A'
  2. 後方ベース型: 「バリエーション部分 + ベース名」
     - 例: '北テラス' → バリエーション '北', ベース名 'テラス'
     - 例: '北ギャラリー' → バリエーション '北', ベース名 'ギャラリー'
     - 例: '南ギャラリー3' → バリエーション '南3', ベース名 'ギャラリー'

- 名称ごとに、まず **前方ベース型** を試し、2.1.2 のパターンに合わなければ **後方ベース型** を試します。
- どちらでもパターンに合わなければ、その名称は「バリエーションなし」とみなし、まとめに使いません（単体でそのまま扱います）。

3-2. バリエーション部分として「認める」パターン

バリエーション部分は、次のいずれかのパターンに **完全一致** する場合のみ有効です。

(A) 数字のみ
- 半角または全角の数字だけから成る文字列。
  - 例: '1', '2', '10', '２', '０３' など

(B) ハイフン '-' + 数字
- 先頭が '-' で、その後ろが数字または数字と '-' の組み合わせのみ。
  - 例: '-1', '-2-3', '-10-2' など

(C) アンダースコア '_' + 数字
- 先頭が '_' で、その後ろが数字だけ。
  - 例: '_1', '_2', '_10' など

(D) ハイフン '-' + 英字
- 先頭が '-' で、その後ろがアルファベットのみ。
  - 例: '-A', '-B', '-C' など

(E) 短い方向・区分など（1〜2文字の漢字・カナ・英字）
- 1〜2文字程度の短い記号的な語。
  - 例: '北', '南', '東', '西', 'A', 'B', '北東' など
- 数字が付く場合（例: '南3', '南01'）は、内部的には '南_3', '南_01' のように扱ってよい（例示のため）。

3-3. バリエーションとして扱わないケース

- アンダースコア '_' の後ろが英字を含む場合、その部分はバリエーションとして扱ってはいけません。
  - 例:
    - 'ServerZone_1', 'ServerZone_2', 'ServerZone_Main', 'ServerZone_Backup' があるとき、
      - '_1', '_2' はバリエーションとして認める。
      - '_Main', '_Backup' はバリエーションとして認めない（各名称をそのまま別々に扱う）。

- 上記(A)〜(E)のどれにも完全一致しない場合、その名称はまとめの対象にしてもよいが、バリエーション部分としては扱わず、単独の名称としてそのまま出力してよい。

【4. まとめる条件】

- 同じ第2階層リストの中で、「ベース名」が同一であり、かつ有効なバリエーション部分を持つ名称が **2つ以上** ある場合、そのベース名でまとめます。
  - 例: '教室101', '教室102', '教室103'
    - ベース名: '教室'
    - バリエーション: '101', '102', '103'
- 同じベース名に属すると判定できる名称が1つしかない場合、その名称はまとめずに元のまま扱います。
  - 例: 比較対象リストに 'ギャラリー1' しかない → 'ギャラリー1' のまま。

- ベース名が完全に一致しない場合、共通する語を含んでいてもまとめてはいけません。
  - 例: '中央テラス', '南屋内テラス'
    - 共通部分 'テラス' があっても、ベース名の位置や形が違うため別々に扱う。
  - 例: 'イベントスペースA', '展示スペースB'
    - 共通部分 'スペース' はあっても、ベース名が一致しないため別々に扱う。

- 用途・機能ごと（「トイレ」「倉庫」「廊下」など）の抽象的なカテゴリを新しく作ってグルーピングしてはいけません。
  - 「トイレ系」「倉庫系」などの新しいキーを作らず、あくまで元の文字列のフォーマットとバリエーションパターンだけでまとめてください。

【5. 代表名称（ベース名）へのまとめ方】

5-1. 前方ベース型（ベース名 + バリエーション）の代表名称

- 形式: 「<ベース名> <v1>, <v2>, ...」
  - 例: '教室101', '教室102', '教室103'
    - 出力名: '教室 101, 102, 103'
  - 例: 'Office-1', 'Office-2', 'Office-06'
    - 出力名: 'Office -1, 2, 06'
  - 例: 'ブースA', 'ブースB', 'ブースB-53', 'ブースC-7'
    - 出力名: 'ブース A, B, B-53, C-7'

5-2. 後方ベース型（バリエーション + ベース名）の代表名称

- 形式: 「<v1>, <v2>, ... <ベース名>」
  - 例: '北テラス', '東テラス'
    - 出力名: '北, 東 テラス'
  - 例: '北ギャラリー', '北東ギャラリー', '南ギャラリー3', '南ギャラリー01'
    - 出力名: '北, 北東, 南_3, 南_01 ギャラリー'
    - ここで '南3', '南01' のような形は '南_3', '南_01' のように表現してよい。

5-3. バリエーションの並び順

- 数字部分を持つバリエーション（'101', '102', '03' など）は、数値として昇順に並べてよいですが、例と完全に一致していなくてもかまいません（ただし Python のリストとして妥当であればよい）。
- 0 埋め（'01', '03' など）は、元の文字列の桁数を保持して出力してください。

【6. 出力形式】

- 出力は、すべての第2階層リストを処理した結果を **1 次元のリスト** にフラット化したものとします。
- 各要素の 'ID' は元の 'ID' をそのまま引き継ぎ、'名前' にはまとめ後の代表名称を入れます。
  - 例: 以下の入力を処理したとき

    入力:
      [
        [ {'ID': 382014, '名前': 'PS5'},
          {'ID': 128504, '名前': 'PS2'} ]
      ]

    代表名称: 'PS 2, 5'

    出力:
      [
        {'ID': 382014, '名前': 'PS 2, 5'},
        {'ID': 128504, '名前': 'PS 2, 5'}
      ]

- サンプル全体（2グループ）の例:

    入力:
      [
        [ {'ID': 382014, '名前': 'PS5'},
          {'ID': 650392, '名前': 'SK'},
          {'ID': 941205, '名前': '事務室5'},
          {'ID': 128504, '名前': 'PS2'},
          {'ID': 507326, '名前': 'EPS1'} ],
        [ {'ID': 104582, '名前': '事務室2'},
          {'ID': 205713, '名前': 'EPS3'},
          {'ID': 396824, '名前': '事務室1'},
          {'ID': 587935, '名前': 'WC'},
          {'ID': 768046, '名前': '事務室3'} ]
      ]

    望ましい出力の一例:
      [
        {'ID': 382014, '名前': 'PS 2, 5'},
        {'ID': 650392, '名前': 'SK'},
        {'ID': 941205, '名前': '事務室 1, 2, 3, 5'},
        {'ID': 128504, '名前': 'PS 2, 5'},
        {'ID': 507326, '名前': 'EPS1'},
        {'ID': 104582, '名前': '事務室 1, 2, 3, 5'},
        {'ID': 205713, '名前': 'EPS3'},
        {'ID': 396824, '名前': '事務室 1, 2, 3, 5'},
        {'ID': 587935, '名前': 'WC'},
        {'ID': 768046, '名前': '事務室 1, 2, 3, 5'}
      ]

- 最終的な出力は、**Python のリスト（[ {...}, {...}, ... ]）だけ** にしてください。
  - 説明文、コメント、余分な文字列（「以下のリストをコピーしてください」など）は絶対に出力しないこと。
  - 無効な Python 構文にならないように注意してください。
